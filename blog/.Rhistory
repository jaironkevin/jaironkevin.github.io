# IMPORTACIÓN DE DATOS
AGRO <- readxl::read_excel("D:/A_TESIS_ESTADISTICA/CAP_RESULTADOS/DATASET/AGRO.xlsx")
# Defino las medidas a calcular
`%>%` <- magrittr::`%>%`
Medidas <- c("obs.", "Mínimo", "1st qu.", "Mediana", "Media", "3rd Qu.",
"Máximo", "SD.","Asimetria", "Curtosis", "Moda")
# Calculo de las estadísticas en AGRO$Producción
Z <- vector(length = length(Medidas))
Z[1] <- round(sum(!is.na(AGRO$Producción)), 0)
Z[2] <- round(min(AGRO$Producción, na.rm = TRUE), 0)
Z[3] <- round(quantile(AGRO$Producción, 0.25, na.rm = TRUE), 0)
Z[4] <- round(median(AGRO$Producción, na.rm = TRUE), 0)
Z[5] <- round(mean(AGRO$Producción, na.rm = TRUE), 0)
Z[6] <- round(quantile(AGRO$Producción, 0.75, na.rm = TRUE), 0)
Z[7] <- round(max(AGRO$Producción, na.rm = TRUE), 0)
Z[8] <- round(sd(AGRO$Producción, na.rm = TRUE), 3)
Z[9] <- round(e1071::skewness(AGRO$Producción, na.rm = TRUE), 3)
Z[10] <- round(e1071::kurtosis(AGRO$Producción, na.rm = TRUE), 3)
Z[11] <- round(Moda(AGRO$Producción), 3)
# Crear el data frame
Z <- data.frame("Estadística" = Medidas, Valor = Z)
Z
AGRO
hist(AGRO$Producción)
# Cargar librerías
library(ggplot2)
library(ggpubr)
library(e1071)
library(modeest)
library(ggstatsplot)
install.packages("ggstatsplot")
library(ggstatsplot)
# Cargar paquetes necesarios
library(ggplot2)
library(e1071)
library(modeest)
install.packages("modeest")
library(modeest)
# Extraer datos
x <- AGRO$Producción
# Medidas de tendencia central
media <- mean(x, na.rm = TRUE)
mediana <- median(x, na.rm = TRUE)
moda <- mfv(x, na_rm = TRUE)[1]  # devuelve una lista, tomamos el primer valor
# Medidas de forma
asimetria <- skewness(x, na.rm = TRUE)
curtosis <- kurtosis(x, na.rm = TRUE)
# Tipo de asimetría
tipo_asimetria <- if (asimetria > 1) {
"Distribución sesgada a la derecha (positiva)"
} else if (asimetria < -1) {
"Distribución sesgada a la izquierda (negativa)"
} else {
"Distribución aproximadamente simétrica"
}
# Crear data frame
df <- data.frame(x = x)
# Graficar
ggplot(df, aes(x = x)) +
geom_histogram(aes(y = ..density..), bins = 30, fill = "lightblue", color = "black") +
geom_density(color = "blue", size = 1) +
geom_vline(xintercept = media, color = "red", linetype = "dashed", size = 1) +
geom_vline(xintercept = mediana, color = "green", linetype = "dotted", size = 1) +
geom_vline(xintercept = moda, color = "purple", linetype = "solid", size = 1) +
annotate("text", x = media, y = 0.00002, label = "Media", color = "red", angle = 90, vjust = -0.5) +
annotate("text", x = mediana, y = 0.00002, label = "Mediana", color = "green", angle = 90, vjust = -0.5) +
annotate("text", x = moda, y = 0.00002, label = "Moda", color = "purple", angle = 90, vjust = -0.5) +
labs(title = "Distribución de la Producción Agrícola",
subtitle = paste0(tipo_asimetria,
"\nAsimetría = ", round(asimetria, 2),
" | Curtosis = ", round(curtosis, 2)),
x = "Producción", y = "Densidad") +
theme_minimal()
titulo <- "Histograma de los Datos Alumnos"
subtitulo <- paste("Media=",media, " Mediana = ",mediana, " Moda=",moda)
ggplot(data = AGRO$Producción, mapping = aes(x=Promedio)) +
geom_histogram(bins=30) +
ggtitle(titulo, subtitle = subtitulo) +
xlab('Valores') + ylab('Frecuencia') +
geom_vline(aes(xintercept = media,
color = "media"),
linetype = "dashed",
size = 1)  +
geom_vline(aes(xintercept = mediana,
color = "mediana"),
linetype = "dashed",
size = 1) +
geom_vline(aes(xintercept = moda,
color = "moda"),
linetype = "dashed",
size = 1)
